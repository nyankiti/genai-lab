# Get Number of Files in a Directory and Its Subdirectories in Java | Baeldung

[View on Baeldung](https://feeds.feedblitz.com/~/916540028/0/baeldung~Get-Number-of-Files-in-a-Directory-and-Its-Subdirectories-in-Java)

このBaeldungの記事は、Javaでディレクトリとそのサブディレクトリ内のファイルの数を取得する方法について解説しています。

**概要:**

1.  **はじめに:**
    *   ファイル数のカウントは、バックアップユーティリティ、ディスク使用量の監視、ファイル同期など、さまざまなプログラミングタスクで必要となる。
    *   この記事では、従来の`java.io.File`アプローチと、より効率的なJava 7で導入されたNIOベースのソリューションの2つの主要な方法について説明する。

2.  **セットアップ:**
    *   ディレクトリ内のファイル数をカウントするには、再帰的な処理が必要となる。
    *   この記事では、開始ディレクトリを引数として受け取り、ファイル数をlong型で返す`numberOfFilesIn(String path)`というメソッドシグネチャを定義する。

3.  **java.io.Fileの使用:**
    *   **Java 8以降:** ストリームを使用して、ディレクトリを再帰的に処理する。
    *   **Java 8以前:** ストリームを使用しない再帰的な実装。
    *   再帰的な実装では、無限ループを避けるために、3つの停止条件を設ける必要がある。

4.  **NIOの使用:**
    *   **Files.find:** `Files.find`メソッドを使用して、ファイル数を効率的にカウントする。
    *   **Walkthrough:** `Files.walk`を使用して、ファイルシステムを反復的にトラバースする。並列ストリームを使用することで、大規模なデータセットに対してパフォーマンスを最適化できる。

5.  **全体的な考慮事項:**
    *   パフォーマンス、セキュリティ、および互換性は、ファイル数のカウントを実装する際に考慮すべき重要な要素である。
    *   大規模なディレクトリ構造には、並列ストリームを使用したNIOアプローチが推奨される。
    *   ユーザー入力を受け入れる場合は、ディレクトリトラバーサルの攻撃を防ぐためにパスを検証する。
    *   国際的なファイル名との互換性を確保するために、NIOのUnicodeサポートを活用する。

6.  **検証:**
    *   記事では、さまざまな実装をテストするために、ファイルとフォルダのサンプル構造を作成し、JUnitテストを実行する。

7.  **結論:**
    *   `java.io.File`は、小さく浅いディレクトリ構造に適しているが、深い階層構造ではスタックオーバーフローのリスクがある。
    *   NIOベースのソリューションは、効率性とスケーラビリティを提供し、大規模なデータセットを処理できる。
    *   ほとんどの最新のアプリケーションでは、NIOアプローチが推奨される。
    *   記事で使用されているすべてのコードは、GitHubで公開されている。
